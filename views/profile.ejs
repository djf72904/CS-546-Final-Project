<html>
  <head>
    <title>Login</title>
    <link rel='stylesheet' href='/css/tailwind.css' />
    <link rel='stylesheet' href='/css/style.css' />
  </head>
  <body>

    <%- include('./partials/_header.ejs'); %>
    <section class="mx-auto w-full">
      <div class="flex justify-between items-center mb-4">
        <h1 class="text-3xl font-bold"><%= profile.display_name %></h1>
        <button id="logout" class="text-white hover:bg-red-600 px-4 py-2 rounded-md bg-red-500">Logout</button>
      </div>

      <section class="py-4 overflow-hidden">
        <div class="mx-auto">
          <div class="flex flex-wrap -m-2">
            <div class="w-full sm:w-1/2 lg:w-1/4 p-2">
              <div class="px-5 py-3 h-full bg-gray-200 rounded-lg">
                <div class="flex flex-wrap justify-between -m-2">
                  <div class="w-auto p-2">
                    <p class="mb-4 text-sm text-neutral-500 font-medium">Best WPM</p>
                    <h3 class="font-heading text-3xl font-semibold"><%= profile.best_wpm %></h3>
                  </div>
                  <div class="w-auto p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-4 opacity-50">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z" />
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.925 3.547 5.975 5.975 0 0 1-2.133-1.001A3.75 3.75 0 0 0 12 18Z" />
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-full sm:w-1/2 lg:w-1/4 p-2">
              <div class="px-5 py-3 h-full  bg-gray-200 rounded-lg">
                <div class="flex flex-wrap justify-between -m-2">
                  <div class="w-auto p-2">
                    <p class="mb-4 text-sm text-neutral-500 font-medium">Average WPM</p>
                    <h3 class="font-heading text-3xl font-semibold"><%= profile.avg_wpm %></h3>
                  </div>
                  <div class="w-auto p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none"  viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-4 opacity-50">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-full sm:w-1/2 lg:w-1/4 p-2">
              <div class="px-5 py-3 h-full  bg-gray-200 rounded-lg">
                <div class="flex flex-wrap justify-between -m-2">
                  <div class="w-auto p-2">
                    <p class="mb-4 text-sm text-neutral-500 font-medium">Max Level</p>
                    <h3 class="font-heading text-3xl font-semibold"><%= profile.max_level %></h3>
                  </div>
                  <div class="w-auto p-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-4 opacity-50">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12" />
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            <div class="w-full sm:w-1/2 lg:w-1/4 p-2">
              <div class="px-5 py-3 h-full  bg-gray-200 rounded-lg">
                <div class="flex flex-wrap justify-between -m-2">
                  <div class="w-auto p-2">
                    <p class="mb-4 text-sm text-neutral-500 font-medium">Average Accuracy</p>
                    <h3 class="font-heading text-3xl font-semibold"><%= profile.avg_accuracy %></h3>
                  </div>
                  <div class="w-auto p-2">

                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-4 opacity-50">
                      <circle cx="12" cy="12" r="10"></circle>
                      <line x1="22" y1="12" x2="18" y2="12"></line>
                      <line x1="6" y1="12" x2="2" y2="12"></line>
                      <line x1="12" y1="6" x2="12" y2="2"></line>
                      <line x1="12" y1="22" x2="12" y2="18"></line></svg>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>
      <section class="flex justify-start space-x-4">
        <button class="tablinks" onClick="handleTabs(event, 'recent-tests')">Recent Tests</button>
        <button class="tablinks" onClick="handleTabs(event, 'friends')">Friends</button>
      </section>
      <div class="mt-4">
        <section id="recent-tests" class="tabcontent">
          <p>Tab 1</p>
        </section>
        <section id="friends" class="tabcontent">
          <p>Tab 2</p>
        </section>
      </div>

    </section>
    <script>
      function handleTabs(evt, name) {
        let i, tabcontent, tablinks;

        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }

        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
          tablinks[i].classList.remove("bg-gray-200", "text-gray-900", "font-medium", "rounded-full", "py-2", "px-4", "text-sm");
        }

        document.getElementById(name).style.display = "block";

        evt.currentTarget.classList.add("bg-gray-200", "text-gray-900", "font-medium", "rounded-full", "py-2", "px-4", "text-sm");
      }

      document.addEventListener("DOMContentLoaded", () => {
        const defaultTab = document.getElementsByClassName("tablinks")[0];
        if (defaultTab) {
          defaultTab.click();
        }
      });
    </script>
    <script>
      const button = document.getElementById("logout");
      button.addEventListener("click", async () => {
        if(window.confirm("Are you sure you want to log out?")){
          const response = await fetch('/logout', {
            method: 'GET',
          });

          if (response.ok) {
            window.location.href = '/';
          } else {
            alert('Error logging out');
          }
        }

      });
    </script>
  </body>
</html>
